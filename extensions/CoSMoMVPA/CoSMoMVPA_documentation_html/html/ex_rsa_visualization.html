    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Visualization of DSMs &#8212; CoSMo Multivariate Pattern Analysis toolbox 1.0rc1 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0rc1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="next" title="Define voxel selection for a searchlight" href="ex_sphere_offsets.html" />
    <link rel="prev" title="Cross-validation part 3: using a dataset measure" href="ex_crossvalidation_measure.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ex_sphere_offsets.html" title="Define voxel selection for a searchlight"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ex_crossvalidation_measure.html" title="Cross-validation part 3: using a dataset measure"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CoSMoMVPA</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="documentation.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="cosmo2013.html" >CoSMo 2013 Multivariate Pattern Analysis Workshop</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="cosmo2013_ex_toc.html" accesskey="U">Exercises</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="visualization-of-dsms">
<h1>Visualization of DSMs<a class="headerlink" href="#visualization-of-dsms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="visualizing-dissimilarity-matrices">
<h2>Visualizing dissimilarity matrices<a class="headerlink" href="#visualizing-dissimilarity-matrices" title="Permalink to this headline">¶</a></h2>
<p>Load the saved variables in the files <em>v1_model.mat</em> and <em>behav_sim.mat</em>. These
should be in your data folder. These are dissimilarity matrices (DSMs) for
our six animals. The v1 model DSM was made by modeling each stimulus image
(jpeg) with a simple v1 cortical model, and then calculating the vector
distances between the stimuli using the features of the model.  The behavioral
DSM was made by having human subjects judge the similarity between every pair of
animals.</p>
<p>Note that these are ordinary DSMs that have zeros on the diagonal and are
symmetric about the diagonal. Use matlabs <strong>imagesc</strong> to view each DSM:</p>
<div class="highlight-matlab"><div class="highlight"><pre><span></span><span class="n">load</span> <span class="n">v1_model</span><span class="p">;</span>
<span class="n">load</span> <span class="n">behav_sim</span><span class="p">;</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">imagesc</span><span class="p">(</span><span class="n">v1_model</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="s">&#39;V1 Model DSM&#39;</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">imagesc</span><span class="p">(</span><span class="n">behav</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="s">&#39;Behavioral DSM&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The categorical structure is obvious in the categorical dissimilarity, but not
in the v1 model DSM.</p>
<p>Now use matlab&#8217;s <strong>linkage</strong> function to do hierarchical clustering on the DSMs.
<strong>linkage</strong> takes input in the form of the flattered upper triangle of the DSM
(as is output by <strong>pdist</strong>). So first flatten each DSM using <strong>squareform</strong>. In
order to view the dendrogram, we need to use matlab&#8217;s <strong>dendrogram</strong> function.</p>
<p>Here is how to do this with the behavioral similarity:</p>
<div class="highlight-matlab"><div class="highlight"><pre><span></span><span class="n">hclus</span> <span class="p">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">squareform</span><span class="p">(</span><span class="n">behav</span><span class="p">));</span>
<span class="c">% We also want to have labels on our dendrogram</span>
<span class="n">labels</span> <span class="p">=</span> <span class="p">{</span><span class="s">&#39;monkey&#39;</span><span class="p">,</span><span class="s">&#39;lemur&#39;</span><span class="p">,</span><span class="s">&#39;mallard&#39;</span><span class="p">,</span><span class="s">&#39;warbler&#39;</span><span class="p">,</span><span class="s">&#39;ladybug&#39;</span><span class="p">,</span><span class="s">&#39;lunamoth&#39;</span><span class="p">};</span>
<span class="n">figure</span><span class="p">();</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">hclus</span><span class="p">,</span> <span class="s">&#39;labels&#39;</span><span class="p">,</span><span class="n">labels</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Behavioral DSM - linkage&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Now let&#8217;s use Matlab&#8217;s classic multidimensional scaling (<strong>cmdscale</strong>) to look at
the DSMs in another way. <strong>cmdscale</strong> returns a set of factor scores for
dimension and stimulus. To view the first 2 dimensions we can use matlab&#8217;s
<strong>text</strong> function:</p>
<div class="highlight-matlab"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="p">=</span> <span class="n">cmdscale</span><span class="p">(</span><span class="n">behav</span><span class="p">);</span>
<span class="n">figure</span><span class="p">();</span>
<span class="n">text</span><span class="p">(</span><span class="n">F</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span> <span class="n">labels</span><span class="p">);</span>
<span class="c">%</span>
<span class="c">% We will also need to set the axes so we can see all of the points</span>
<span class="c">% Let&#39;s use the maximum absolute magnitude</span>
<span class="n">mx</span> <span class="p">=</span> <span class="n">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">F</span><span class="p">(:)));</span>
<span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="n">mx</span> <span class="n">mx</span><span class="p">]);</span> <span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="n">mx</span> <span class="n">mx</span><span class="p">]);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Behavioral DSM, cmdscale, dims 1 and 2&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Do this also for the V1 model DSM.</p>
<p>Now using the data from the &#8220;allruns&#8221; datasets, load one subject at a time,
compute the DSMs for VT and EV. Visualize them side-by-side using the three
methods above so that the output looks like the image below (subject 4).  You
will need to use matlab&#8217;s subplot function for this.</p>
<img alt="_images/visualize.png" src="_images/visualize.png" />
<p>Hint: <a class="reference internal" href="matlab/run_rsa_visualize_skl.html#run-rsa-visualize-skl"><span class="std std-ref">run rsa visualize skl</span></a>.</p>
<p>Solution: <a class="reference internal" href="matlab/run_rsa_visualize.html#run-rsa-visualize"><span class="std std-ref">run rsa visualize</span></a> / <a class="reference external" href="_static/publish/run_run_rsa_visualize.html">Matlab output: run_run_rsa_visualize</a></p>
</div>
<div class="section" id="centering-the-data">
<h2>Centering the data<a class="headerlink" href="#centering-the-data" title="Permalink to this headline">¶</a></h2>
<p>A dataset can be thought of as a set of points in N-dimensional vector space.
This is easy to visualize with 2 or three dimensions (voxels), but it is
difficult to do with several hundred dimensions. Nevertheless, the math stays
the same whether you are dealing with 3 voxels or 3 hundred. Remember that our
fMRI data comes from a time-course analysis that included some estimation of the
<em>baseline</em> activity for each voxel. The statistics we have for our categories
are estimations of the differences from that baseline.  This means that the
origin of our vector space corresponds to that <em>arbitrary</em> baseline.</p>
<p>Because correlation distance is a measure of the angles between vectors, it is
sensitive to where the data cloud resides with respect to the origin. Ideally,
the origin of the vector space has a non-arbitray location so that it is
maximally informative about the relationships between our stimuli. We can
accomplish this by centering the data cloud on the origin of the space by
removing the mean value across conditions at each voxel.</p>
<p>See what happens to the correlation between two vectors marked with blue X and a
red cross in the figure below. On the left the data cloud has an arbitray
origin, and the vectors are almost perfectly correlated. After demeaning, they
are negatively correlated.</p>
<a class="reference internal image-reference" href="_images/demean.png"><img alt="_images/demean.png" src="_images/demean.png" style="width: 600px;" /></a>
<p>Thus before calculating a neural DSM, it is good to center the data first by
demeaning. Rerun your visualization script above by centering the data first.
How does this change the results?</p>
<p>Solution: <a class="reference internal" href="matlab/run_demean.html#run-demean"><span class="std std-ref">run demean</span></a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/cosmomvpa_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Visualization of DSMs</a><ul>
<li><a class="reference internal" href="#visualizing-dissimilarity-matrices">Visualizing dissimilarity matrices</a></li>
<li><a class="reference internal" href="#centering-the-data">Centering the data</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ex_crossvalidation_measure.html"
                        title="previous chapter">Cross-validation part 3: using a dataset measure</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ex_sphere_offsets.html"
                        title="next chapter">Define voxel selection for a searchlight</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ex_rsa_visualization.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ex_sphere_offsets.html" title="Define voxel selection for a searchlight"
             >next</a> |</li>
        <li class="right" >
          <a href="ex_crossvalidation_measure.html" title="Cross-validation part 3: using a dataset measure"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CoSMoMVPA</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="documentation.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="cosmo2013.html" >CoSMo 2013 Multivariate Pattern Analysis Workshop</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="cosmo2013_ex_toc.html" >Exercises</a> &#187;</li> 
      </ul>
    </div>
      <div class="footer">
       <span class="creativecommons">
          <a href="http://opensource.org/licenses/MIT" >
          <img src="_static/mit-license_logo.png"
               border="0" alt="Creative Commons License"/>
         </a> 
         
        <a href="copyright.html">Copyright 2013-2016 Nikolaas N. Oosterhof, Andrew C. Connolly, CoSMoMVPA contributors</a>.
        CoSMoMVPA is licensed under a <a href="http://opensource.org/licenses/MIT">Expat (MIT) License</a>.
       </span>
      </div>
  </body>
</html>
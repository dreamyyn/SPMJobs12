
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Dataset Basics</title><meta name="generator" content="MATLAB 8.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-12-01"><meta name="DC.source" content="run_operations_on_datasets.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Dataset Basics</h1><!--introduction--><p>Run operations on datasets</p><div><ol><li>For CoSMoMVPA's copyright information and license terms,   #</li><li>see the COPYING file distributed with CoSMoMVPA.           #</li></ol></div><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Load data and set targets</a></li><li><a href="#2">Various slicing operations on the samples</a></li><li><a href="#3">Get sample indices for primates and bugs</a></li><li><a href="#4">Subtract mean pattern</a></li><li><a href="#5">Store and visualize the results</a></li><li><a href="#6">Plot results</a></li></ul></div><h2>Load data and set targets<a name="1"></a></h2><p>Load data as before setting targets and chunks appropriately</p><pre class="codeinput">config=cosmo_config();
data_path=fullfile(config.tutorial_data_path,<span class="string">'ak6'</span>,<span class="string">'s01'</span>);
mask_fn = fullfile(data_path, <span class="string">'vt_mask.nii'</span>);
data_fn = fullfile(data_path, <span class="string">'glm_T_stats_perrun.nii'</span>);
ds=cosmo_fmri_dataset(data_fn, <span class="string">'mask'</span>, mask_fn);

<span class="comment">% set ds.sa.targets (trial conditions) to the 60x1 column vector:</span>
<span class="comment">% [ 1 2 3 4 5 6 1 2 3 ... 5 6 ]'</span>
<span class="comment">% &gt;@@&gt;</span>
ds.sa.targets = repmat((1:6)',10,1);
<span class="comment">% &lt;@@&lt;</span>

<span class="comment">% set ds.sa.chunks (acquistion run number) to the 60x1 column vector:</span>
<span class="comment">% [ 1 1 1 1 1 1 2 2 2 ... 10 10 ]'</span>
<span class="comment">% &gt;@@&gt;</span>
ds.sa.chunks = ceil((1:60)'/6);
<span class="comment">% &lt;@@&lt;</span>

<span class="comment">% set the labels</span>
labels = repmat({   <span class="string">'monkey'</span>;
                    <span class="string">'lemur'</span>;
                    <span class="string">'mallard'</span>;
                    <span class="string">'warbler'</span>;
                    <span class="string">'ladybug'</span>;
                    <span class="string">'lunamoth'</span>},10,1);
ds.sa.labels = labels;

<span class="comment">% This particular ROI has a few constant features due to</span>
<span class="comment">% not-so-agressive masking, so remove constant features</span>
ds=cosmo_remove_useless_data(ds);
</pre><h2>Various slicing operations on the samples<a name="2"></a></h2><pre class="codeinput"><span class="comment">% only get data in chunks 1 and 2.</span>
<span class="comment">% Make a logical mask indicating where .ds.chunks less than or equal to 2</span>
<span class="comment">% and store the result in a variable 'chunks12_msk'.</span>
<span class="comment">% Then use cosmo_slice to select these samples and assign it to a variable</span>
<span class="comment">% 'ds_chunks12'</span>
<span class="comment">% (hint: you can use cosmo_match or just '&lt;=')</span>
<span class="comment">% &gt;@@&gt;</span>
chunks12_msk=ds.sa.chunks&lt;=2;
ds_chunks12=cosmo_slice(ds,chunks12_msk);
cosmo_disp(ds_chunks12);
<span class="comment">% &lt;@@&lt;</span>

<span class="comment">% As above, but only select data with targets equal to 1 or 3.</span>
<span class="comment">% (corresponding to {'monkey','mallard'})</span>
<span class="comment">% &gt;@@&gt;</span>
<span class="comment">% (there are multiple ways of doing this)</span>
targets_13=ds.sa.targets==1 | ds.sa.targets==3; <span class="comment">% element-wise logical 'or'</span>
ds_targets13=cosmo_slice(ds,targets_13);
cosmo_disp(ds_targets13);

<span class="comment">% this is an alternative way to achieve the same goal</span>
targets_13_alt=cosmo_match(ds.sa.targets,[1 3]); <span class="comment">% using cosmo_match</span>
ds_targets13_alt=cosmo_slice(ds,targets_13_alt);
cosmo_disp(ds_targets13_alt);

<span class="comment">% sanity check showing they are the same</span>
assert(isequal(ds_targets13,ds_targets13_alt));

<span class="comment">% alterative using cosmo_match and the labels</span>
labels_monkey_or_mallard=cosmo_match(ds.sa.labels,{<span class="string">'monkey'</span>,<span class="string">'mallard'</span>});
ds_targets13_alt2=cosmo_slice(ds,labels_monkey_or_mallard);
cosmo_disp(ds_targets13_alt2);

<span class="comment">% sanity check showing they are the same</span>
assert(isequal(ds_targets13,ds_targets13_alt2));
<span class="comment">% &lt;@@&lt;</span>
</pre><pre class="codeoutput">.a                                                                   
  .vol                                                               
    .mat                                                             
      [ -3         0         0       121                             
         0         3         0      -114                             
         0         0         3     -11.1                             
         0         0         0         1 ]                           
    .xform                                                           
      'scanner_anat'                                                 
    .dim                                                             
      [ 80        80        43 ]                                     
  .fdim                                                              
    .labels                                                          
      { 'i'                                                          
        'j'                                                          
        'k' }                                                        
    .values                                                          
      { [ 1         2         3  ...  78        79        80 ]@1x80  
        [ 1         2         3  ...  78        79        80 ]@1x80  
        [ 1         2         3  ...  41        42        43 ]@1x43 }
.sa                                                                  
  .targets                                                           
    [ 1                                                              
      2                                                              
      3                                                              
      :                                                              
      4                                                              
      5                                                              
      6 ]@12x1                                                       
  .chunks                                                            
    [ 1                                                              
      1                                                              
      1                                                              
      :                                                              
      2                                                              
      2                                                              
      2 ]@12x1                                                       
  .labels                                                            
    { 'monkey'                                                       
      'lemur'                                                        
      'mallard'                                                      
          :                                                          
      'warbler'                                                      
      'ladybug'                                                      
      'lunamoth' }@12x1                                              
.samples                                                             
  [ 2.73      2.62      2.19  ...  0.669      1.78      2.42         
    2.51      2.99      3.25  ...   1.06      1.61     0.943         
     1.3     0.646     0.591  ...   1.51      1.75      3.08         
      :        :         :           :          :        :           
    1.89      1.37      3.05  ...   4.38      4.46      3.86         
    3.46      3.08       4.2  ...   2.78      1.77      1.19         
    3.25      2.18      3.99  ...   4.21      4.54      3.41 ]@12x384
.fa                                                                  
  .i                                                                 
    [ 32        33        34  ...  28        29        29 ]@1x384    
  .j                                                                 
    [ 24        24        24  ...  25        25        26 ]@1x384    
  .k                                                                 
    [ 3         3         3  ...  9         9         9 ]@1x384      
.a                                                                   
  .vol                                                               
    .mat                                                             
      [ -3         0         0       121                             
         0         3         0      -114                             
         0         0         3     -11.1                             
         0         0         0         1 ]                           
    .xform                                                           
      'scanner_anat'                                                 
    .dim                                                             
      [ 80        80        43 ]                                     
  .fdim                                                              
    .labels                                                          
      { 'i'                                                          
        'j'                                                          
        'k' }                                                        
    .values                                                          
      { [ 1         2         3  ...  78        79        80 ]@1x80  
        [ 1         2         3  ...  78        79        80 ]@1x80  
        [ 1         2         3  ...  41        42        43 ]@1x43 }
.sa                                                                  
  .targets                                                           
    [ 1                                                              
      3                                                              
      1                                                              
      :                                                              
      3                                                              
      1                                                              
      3 ]@20x1                                                       
  .chunks                                                            
    [  1                                                             
       1                                                             
       2                                                             
       :                                                             
       9                                                             
      10                                                             
      10 ]@20x1                                                      
  .labels                                                            
    { 'monkey'                                                       
      'mallard'                                                      
      'monkey'                                                       
         :                                                           
      'mallard'                                                      
      'monkey'                                                       
      'mallard' }@20x1                                               
.samples                                                             
  [ 2.73      2.62      2.19  ...  0.669      1.78      2.42         
     1.3     0.646     0.591  ...   1.51      1.75      3.08         
    3.52      2.01      3.32  ...    1.8      2.54     0.949         
      :        :         :           :         :         :           
    2.24      2.37      3.27  ...   4.61      2.13      4.32         
    2.31      1.61       1.6  ...  0.839     0.544      2.83         
    2.13      1.22      2.12  ...    2.3      3.14      1.99 ]@20x384
.fa                                                                  
  .i                                                                 
    [ 32        33        34  ...  28        29        29 ]@1x384    
  .j                                                                 
    [ 24        24        24  ...  25        25        26 ]@1x384    
  .k                                                                 
    [ 3         3         3  ...  9         9         9 ]@1x384      
.a                                                                   
  .vol                                                               
    .mat                                                             
      [ -3         0         0       121                             
         0         3         0      -114                             
         0         0         3     -11.1                             
         0         0         0         1 ]                           
    .xform                                                           
      'scanner_anat'                                                 
    .dim                                                             
      [ 80        80        43 ]                                     
  .fdim                                                              
    .labels                                                          
      { 'i'                                                          
        'j'                                                          
        'k' }                                                        
    .values                                                          
      { [ 1         2         3  ...  78        79        80 ]@1x80  
        [ 1         2         3  ...  78        79        80 ]@1x80  
        [ 1         2         3  ...  41        42        43 ]@1x43 }
.sa                                                                  
  .targets                                                           
    [ 1                                                              
      3                                                              
      1                                                              
      :                                                              
      3                                                              
      1                                                              
      3 ]@20x1                                                       
  .chunks                                                            
    [  1                                                             
       1                                                             
       2                                                             
       :                                                             
       9                                                             
      10                                                             
      10 ]@20x1                                                      
  .labels                                                            
    { 'monkey'                                                       
      'mallard'                                                      
      'monkey'                                                       
         :                                                           
      'mallard'                                                      
      'monkey'                                                       
      'mallard' }@20x1                                               
.samples                                                             
  [ 2.73      2.62      2.19  ...  0.669      1.78      2.42         
     1.3     0.646     0.591  ...   1.51      1.75      3.08         
    3.52      2.01      3.32  ...    1.8      2.54     0.949         
      :        :         :           :         :         :           
    2.24      2.37      3.27  ...   4.61      2.13      4.32         
    2.31      1.61       1.6  ...  0.839     0.544      2.83         
    2.13      1.22      2.12  ...    2.3      3.14      1.99 ]@20x384
.fa                                                                  
  .i                                                                 
    [ 32        33        34  ...  28        29        29 ]@1x384    
  .j                                                                 
    [ 24        24        24  ...  25        25        26 ]@1x384    
  .k                                                                 
    [ 3         3         3  ...  9         9         9 ]@1x384      
.a                                                                   
  .vol                                                               
    .mat                                                             
      [ -3         0         0       121                             
         0         3         0      -114                             
         0         0         3     -11.1                             
         0         0         0         1 ]                           
    .xform                                                           
      'scanner_anat'                                                 
    .dim                                                             
      [ 80        80        43 ]                                     
  .fdim                                                              
    .labels                                                          
      { 'i'                                                          
        'j'                                                          
        'k' }                                                        
    .values                                                          
      { [ 1         2         3  ...  78        79        80 ]@1x80  
        [ 1         2         3  ...  78        79        80 ]@1x80  
        [ 1         2         3  ...  41        42        43 ]@1x43 }
.sa                                                                  
  .targets                                                           
    [ 1                                                              
      3                                                              
      1                                                              
      :                                                              
      3                                                              
      1                                                              
      3 ]@20x1                                                       
  .chunks                                                            
    [  1                                                             
       1                                                             
       2                                                             
       :                                                             
       9                                                             
      10                                                             
      10 ]@20x1                                                      
  .labels                                                            
    { 'monkey'                                                       
      'mallard'                                                      
      'monkey'                                                       
         :                                                           
      'mallard'                                                      
      'monkey'                                                       
      'mallard' }@20x1                                               
.samples                                                             
  [ 2.73      2.62      2.19  ...  0.669      1.78      2.42         
     1.3     0.646     0.591  ...   1.51      1.75      3.08         
    3.52      2.01      3.32  ...    1.8      2.54     0.949         
      :        :         :           :         :         :           
    2.24      2.37      3.27  ...   4.61      2.13      4.32         
    2.31      1.61       1.6  ...  0.839     0.544      2.83         
    2.13      1.22      2.12  ...    2.3      3.14      1.99 ]@20x384
.fa                                                                  
  .i                                                                 
    [ 32        33        34  ...  28        29        29 ]@1x384    
  .j                                                                 
    [ 24        24        24  ...  25        25        26 ]@1x384    
  .k                                                                 
    [ 3         3         3  ...  9         9         9 ]@1x384      
</pre><h2>Get sample indices for primates and bugs<a name="3"></a></h2><p>Get the sample indices that correspond to primates and bugs, and assign the result to variables 'primate_idx' and 'bug_idx'</p><pre class="codeinput"><span class="comment">% &gt;@@&gt;</span>
primate_idx = ds.sa.targets &lt;= 2;
bug_idx = ds.sa.targets &gt; 4;
<span class="comment">% &lt;@@&lt;</span>



<span class="comment">% Slice the dataset</span>
<span class="comment">% use the indices in 'primate_idx' and 'bug_idx' as input to cosmo_slice,</span>
<span class="comment">% and store the result in 'primate_ds' and 'bug_ds', respectively.</span>

<span class="comment">% &gt;@@&gt;</span>
primate_ds = cosmo_slice(ds, primate_idx);
bug_ds = cosmo_slice(ds, bug_idx);
<span class="comment">% &lt;@@&lt;</span>
</pre><h2>Subtract mean pattern<a name="4"></a></h2><p>Find the mean pattern for primates and bugs and subtract the bug pattern from the primate pattern</p><pre class="codeinput"><span class="comment">% &gt;@@&gt;</span>
primates_mean = mean(primate_ds.samples, 1);
bugs_mean = mean(bug_ds.samples, 1);
primates_minus_bugs = primates_mean - bugs_mean;
<span class="comment">% &lt;@@&lt;</span>
</pre><h2>Store and visualize the results<a name="5"></a></h2><p>Finally save the result as a dataset with the original header. Just replace ds.samples with the result and remove the sample attributes. Then convert back to nifti and save it using the cosmo_map2fmri function.</p><pre class="codeinput"><span class="comment">% &gt;@@&gt;</span>
ds_primates_minus_bugs=ds; <span class="comment">% make a copy</span>
ds_primates_minus_bugs.samples = primates_minus_bugs;
ds_primates_minus_bugs.sa=struct();
cosmo_check_dataset(ds_primates_minus_bugs); <span class="comment">%good practice</span>

<span class="comment">% store to disc</span>
output_path=config.output_data_path;
output_fn=fullfile(output_path, <span class="string">'primates_minus_bugs.nii'</span>);
ni = cosmo_map2fmri(ds_primates_minus_bugs, output_fn);
<span class="comment">% &lt;@@&lt;</span>
</pre><h2>Plot results<a name="6"></a></h2><pre class="codeinput">figure
<span class="comment">%... using cosmo_plot_slices</span>

<span class="comment">% &gt;@@&gt;</span>
cosmo_plot_slices(ds_primates_minus_bugs)
<span class="comment">% &lt;@@&lt;</span>

<span class="comment">% ... using AFNI, FSL, or Matlab's imagesc</span>
figure

<span class="comment">% &gt;@@&gt;</span>
imagesc(rot90(ni.img(:,:,4)));
title(<span class="string">'Primates minus Bugs'</span>)
box <span class="string">off</span>
ylabel(<span class="string">'P &lt;-  y  -&gt;  A'</span>),
xlabel(<span class="string">'L &lt;-  x  -&gt;  R'</span>)
<span class="comment">% &lt;@@&lt;</span>
</pre><img vspace="5" hspace="5" src="run_operations_on_datasets_01.png" alt=""> <img vspace="5" hspace="5" src="run_operations_on_datasets_02.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Dataset Basics
% Run operations on datasets
%
% #   For CoSMoMVPA's copyright information and license terms,   #
% #   see the COPYING file distributed with CoSMoMVPA.           #

%% Load data and set targets
% Load data as before setting targets and chunks appropriately

config=cosmo_config();
data_path=fullfile(config.tutorial_data_path,'ak6','s01');
mask_fn = fullfile(data_path, 'vt_mask.nii');
data_fn = fullfile(data_path, 'glm_T_stats_perrun.nii');
ds=cosmo_fmri_dataset(data_fn, 'mask', mask_fn);

% set ds.sa.targets (trial conditions) to the 60x1 column vector:
% [ 1 2 3 4 5 6 1 2 3 ... 5 6 ]'
% >@@>
ds.sa.targets = repmat((1:6)',10,1);
% <@@<

% set ds.sa.chunks (acquistion run number) to the 60x1 column vector:
% [ 1 1 1 1 1 1 2 2 2 ... 10 10 ]'
% >@@>
ds.sa.chunks = ceil((1:60)'/6);
% <@@<

% set the labels
labels = repmat({   'monkey';
                    'lemur';
                    'mallard';
                    'warbler';
                    'ladybug';
                    'lunamoth'},10,1);
ds.sa.labels = labels;

% This particular ROI has a few constant features due to
% not-so-agressive masking, so remove constant features
ds=cosmo_remove_useless_data(ds);




%% Various slicing operations on the samples

% only get data in chunks 1 and 2.
% Make a logical mask indicating where .ds.chunks less than or equal to 2
% and store the result in a variable 'chunks12_msk'.
% Then use cosmo_slice to select these samples and assign it to a variable
% 'ds_chunks12'
% (hint: you can use cosmo_match or just '<=')
% >@@>
chunks12_msk=ds.sa.chunks<=2;
ds_chunks12=cosmo_slice(ds,chunks12_msk);
cosmo_disp(ds_chunks12);
% <@@<

% As above, but only select data with targets equal to 1 or 3.
% (corresponding to {'monkey','mallard'})
% >@@>
% (there are multiple ways of doing this)
targets_13=ds.sa.targets==1 | ds.sa.targets==3; % element-wise logical 'or'
ds_targets13=cosmo_slice(ds,targets_13);
cosmo_disp(ds_targets13);

% this is an alternative way to achieve the same goal
targets_13_alt=cosmo_match(ds.sa.targets,[1 3]); % using cosmo_match
ds_targets13_alt=cosmo_slice(ds,targets_13_alt);
cosmo_disp(ds_targets13_alt);

% sanity check showing they are the same
assert(isequal(ds_targets13,ds_targets13_alt));

% alterative using cosmo_match and the labels
labels_monkey_or_mallard=cosmo_match(ds.sa.labels,{'monkey','mallard'});
ds_targets13_alt2=cosmo_slice(ds,labels_monkey_or_mallard);
cosmo_disp(ds_targets13_alt2);

% sanity check showing they are the same
assert(isequal(ds_targets13,ds_targets13_alt2));
% <@@<

%% Get sample indices for primates and bugs
% Get the sample indices that correspond to primates and bugs,
% and assign the result to variables 'primate_idx' and 'bug_idx'

% >@@>
primate_idx = ds.sa.targets <= 2;
bug_idx = ds.sa.targets > 4;
% <@@<



% Slice the dataset
% use the indices in 'primate_idx' and 'bug_idx' as input to cosmo_slice,
% and store the result in 'primate_ds' and 'bug_ds', respectively.

% >@@>
primate_ds = cosmo_slice(ds, primate_idx);
bug_ds = cosmo_slice(ds, bug_idx);
% <@@<

%% Subtract mean pattern
% Find the mean pattern for primates and bugs and subtract the bug pattern from
% the primate pattern

% >@@>
primates_mean = mean(primate_ds.samples, 1);
bugs_mean = mean(bug_ds.samples, 1);
primates_minus_bugs = primates_mean - bugs_mean;
% <@@<

%% Store and visualize the results
% Finally save the result as a dataset with the original header.
% Just replace ds.samples with the result and remove the sample attributes.
% Then convert back to nifti and save it using the cosmo_map2fmri function.

% >@@>
ds_primates_minus_bugs=ds; % make a copy
ds_primates_minus_bugs.samples = primates_minus_bugs;
ds_primates_minus_bugs.sa=struct();
cosmo_check_dataset(ds_primates_minus_bugs); %good practice

% store to disc
output_path=config.output_data_path;
output_fn=fullfile(output_path, 'primates_minus_bugs.nii');
ni = cosmo_map2fmri(ds_primates_minus_bugs, output_fn);
% <@@<

%% Plot results
figure
%... using cosmo_plot_slices

% >@@>
cosmo_plot_slices(ds_primates_minus_bugs)
% <@@<

% ... using AFNI, FSL, or Matlab's imagesc
figure

% >@@>
imagesc(rot90(ni.img(:,:,4)));
title('Primates minus Bugs')
box off
ylabel('P <-  y  ->  A'),
xlabel('L <-  x  ->  R')
% <@@<

##### SOURCE END #####
--></body></html>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>run_nifti_basics</title><meta name="generator" content="MATLAB 8.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-12-01"><meta name="DC.source" content="run_nifti_basics.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">NIFTI basics</a></li><li><a href="#2">Show the contents of the nifti header</a></li><li><a href="#3">Plot slices</a></li><li><a href="#4">Plot slice in all three dimensions</a></li></ul></div><h2>NIFTI basics<a name="1"></a></h2><p>In this example, load a brain and visualize it in matlab</p><div><ol><li>For CoSMoMVPA's copyright information and license terms,   #</li><li>see the COPYING file distributed with CoSMoMVPA.           #</li></ol></div><pre class="codeinput"><span class="comment">% Set the path.</span>
config=cosmo_config();
data_path=fullfile(config.tutorial_data_path,<span class="string">'ak6'</span>,<span class="string">'s01'</span>);

<span class="comment">% Set filename</span>
fn=fullfile(data_path, <span class="string">'brain.nii'</span>);

<span class="comment">% Load with nifti</span>
ni=load_nii(fn);
</pre><h2>Show the contents of the nifti header<a name="2"></a></h2><pre class="codeinput">cosmo_disp(ni.hdr);

<span class="comment">% print the dimensions</span>
size(ni.img)

<span class="comment">% plot a histogram of the intensities (use only values greater than zero)</span>
<span class="comment">% change the number of bins</span>
<span class="comment">% &gt;@@&gt;</span>
figure
set(gcf, <span class="string">'name'</span>, <span class="string">'Intensity Histogram'</span>)
hist(ni.img(ni.img(:) &gt; 0), 100)
xlabel(<span class="string">'intensity'</span>)
ylabel(<span class="string">'count'</span>)
box <span class="string">off</span>
<span class="comment">% &lt;@@&lt;</span>
</pre><pre class="codeoutput">.hk                                                          
  .sizeof_hdr                                                
    [ 348 ]                                                  
  .data_type                                                 
    ''                                                       
  .db_name                                                   
    ''                                                       
  .extents                                                   
    [ 0 ]                                                    
  .session_error                                             
    [ 0 ]                                                    
  .regular                                                   
    'r'                                                      
  .dim_info                                                  
    [ 0 ]                                                    
.dime                                                        
  .dim                                                       
    [ 3       160       256  ...  1         1         1 ]@1x8
  .intent_p1                                                 
    [ 0 ]                                                    
  .intent_p2                                                 
    [ 0 ]                                                    
  .intent_p3                                                 
    [ 0 ]                                                    
  .intent_code                                               
    [ 0 ]                                                    
  .datatype                                                  
    [ 16 ]                                                   
  .bitpix                                                    
    [ 32 ]                                                   
  .slice_start                                               
    [ 0 ]                                                    
  .pixdim                                                    
    [ 1         1     0.938  ...  0         0         0 ]@1x8
  .vox_offset                                                
    [ 4.13e+03 ]                                             
  .scl_slope                                                 
    [ 0 ]                                                    
  .scl_inter                                                 
    [ 0 ]                                                    
  .slice_end                                                 
    [ 0 ]                                                    
  .slice_code                                                
    [ 0 ]                                                    
  .xyzt_units                                                
    [ 2 ]                                                    
  .cal_max                                                   
    [ 0 ]                                                    
  .cal_min                                                   
    [ 0 ]                                                    
  .slice_duration                                            
    [ 0 ]                                                    
  .toffset                                                   
    [ 0 ]                                                    
  .glmax                                                     
    [ 3.56e+03 ]                                             
  .glmin                                                     
    [ 0 ]                                                    
.hist                                                        
  .descrip                                                   
    ''                                                       
  .aux_file                                                  
    ''                                                       
  .qform_code                                                
    [ 0 ]                                                    
  .sform_code                                                
    [ 0 ]                                                    
  .quatern_b                                                 
    [ 0.5 ]                                                  
  .quatern_c                                                 
    [ -0.5 ]                                                 
  .quatern_d                                                 
    [ -0.5 ]                                                 
  .qoffset_x                                                 
    [ -83.9 ]                                                
  .qoffset_y                                                 
    [ 123 ]                                                  
  .qoffset_z                                                 
    [ -64.9 ]                                                
  .srow_x                                                    
    [ 0         0         1     -83.9 ]                      
  .srow_y                                                    
    [ -0.938         0         0       123 ]                 
  .srow_z                                                    
    [ 0     0.938         0     -64.9 ]                      
  .intent_name                                               
    ''                                                       
  .magic                                                     
    'n+1'                                                    
  .originator                                                
    [ 84.9       125      70.2        63         0 ]         
  .rot_orient                                                
    [ 3         1         2 ]                                
  .flip_orient                                               
    [ 0         3         0 ]                                

ans =

   160   256   256

</pre><img vspace="5" hspace="5" src="run_nifti_basics_01.png" alt=""> <h2>Plot slices<a name="3"></a></h2><p>plot a sagital, coronal and axial slice at voxel positions (80,150,80) using squeeze and tranpose ("'") where necessary. (bonus points for axis labels and proper orientations, i.e. in the sagittal view the front of the brain is on the left and the back is on the right)</p><pre class="codeinput">ii=80;
jj=150;
kk=80;
figure
<span class="comment">% &gt;@@&gt;</span>
set(gcf, <span class="string">'name'</span>, <span class="string">'Canonical Views'</span>)
subplot(2,2,1)
<span class="comment">%imagesc(fliplr(rot90(squeeze(ni.img(ii, :, :)))))</span>
imagesc(squeeze(ni.img(ii,end:-1:1,end:-1:1))')
axis <span class="string">image</span>
title(<span class="string">'SAG'</span>)
xlabel(<span class="string">'y [AP]'</span>)
ylabel(<span class="string">'z [SI]'</span>)

subplot(2,2,2)
<span class="comment">%imagesc(fliplr(rot90(squeeze(ni.img(:, jj, :)))))</span>
imagesc(squeeze(ni.img(:,jj,end:-1:1))')
axis <span class="string">image</span>
title(<span class="string">'COR'</span>)
xlabel(<span class="string">'x [LR]'</span>)
ylabel(<span class="string">'z [SI]'</span>)

subplot(2,2,3)
<span class="comment">%imagesc(fliplr(rot90(ni.img(:, :, kk))))</span>
imagesc(squeeze(ni.img(:,end:-1:1,kk))')
axis <span class="string">image</span>
title(<span class="string">'TRA'</span>)
xlabel(<span class="string">'x [LR]'</span>)
ylabel(<span class="string">'y [AP]'</span>)
<span class="comment">% &lt;@@&lt;</span>
</pre><img vspace="5" hspace="5" src="run_nifti_basics_02.png" alt=""> <h2>Plot slice in all three dimensions<a name="4"></a></h2><p>This uses the cosmo_plot_slices helper function</p><pre class="codeinput">slice_step=15;
strView = {<span class="string">'SAG'</span>, <span class="string">'COR'</span>, <span class="string">'TRA'</span>};

<span class="keyword">for</span> dim=1:3
    figure
    <span class="comment">% &gt;@@&gt;</span>
    cosmo_plot_slices(ni.img, dim, slice_step)
    axh = findobj(gcf, <span class="string">'Type'</span>, <span class="string">'axes'</span>);
    set(axh, <span class="string">'visible'</span>, <span class="string">'off'</span>)
    set(gcf, <span class="string">'name'</span>, sprintf(<span class="string">'Slices %s'</span>, strView{dim}));
    <span class="comment">% &lt;@@&lt;</span>
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="run_nifti_basics_03.png" alt=""> <img vspace="5" hspace="5" src="run_nifti_basics_04.png" alt=""> <img vspace="5" hspace="5" src="run_nifti_basics_05.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% NIFTI basics
% In this example, load a brain and visualize it in matlab
%
% #   For CoSMoMVPA's copyright information and license terms,   #
% #   see the COPYING file distributed with CoSMoMVPA.           #

% Set the path.
config=cosmo_config();
data_path=fullfile(config.tutorial_data_path,'ak6','s01');

% Set filename
fn=fullfile(data_path, 'brain.nii');

% Load with nifti
ni=load_nii(fn);

%% Show the contents of the nifti header
cosmo_disp(ni.hdr);

% print the dimensions
size(ni.img)

% plot a histogram of the intensities (use only values greater than zero)
% change the number of bins
% >@@>
figure
set(gcf, 'name', 'Intensity Histogram')
hist(ni.img(ni.img(:) > 0), 100)
xlabel('intensity')
ylabel('count')
box off
% <@@<
%% Plot slices
% plot a sagital, coronal and axial slice
% at voxel positions (80,150,80) using squeeze and tranpose ("'") where
% necessary.
% (bonus points for axis labels and proper orientations, i.e. in the
% sagittal view the front of the brain is on the left and the back
% is on the right)
ii=80;
jj=150;
kk=80;
figure
% >@@>
set(gcf, 'name', 'Canonical Views')
subplot(2,2,1)
%imagesc(fliplr(rot90(squeeze(ni.img(ii, :, :)))))
imagesc(squeeze(ni.img(ii,end:-1:1,end:-1:1))')
axis image
title('SAG')
xlabel('y [AP]')
ylabel('z [SI]')

subplot(2,2,2)
%imagesc(fliplr(rot90(squeeze(ni.img(:, jj, :)))))
imagesc(squeeze(ni.img(:,jj,end:-1:1))')
axis image
title('COR')
xlabel('x [LR]')
ylabel('z [SI]')

subplot(2,2,3)
%imagesc(fliplr(rot90(ni.img(:, :, kk))))
imagesc(squeeze(ni.img(:,end:-1:1,kk))')
axis image
title('TRA')
xlabel('x [LR]')
ylabel('y [AP]')
% <@@<
%% Plot slice in all three dimensions
% This uses the cosmo_plot_slices helper function
slice_step=15;
strView = {'SAG', 'COR', 'TRA'};

for dim=1:3
    figure
    % >@@>
    cosmo_plot_slices(ni.img, dim, slice_step)
    axh = findobj(gcf, 'Type', 'axes');
    set(axh, 'visible', 'off')
    set(gcf, 'name', sprintf('Slices %s', strView{dim}));
    % <@@<
end

##### SOURCE END #####
--></body></html>
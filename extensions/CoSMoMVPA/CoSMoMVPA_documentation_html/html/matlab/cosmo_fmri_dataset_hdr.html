    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>cosmo fmri dataset hdr &#8212; CoSMo Multivariate Pattern Analysis toolbox 1.0rc1 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0rc1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="cosmo fmri deoblique hdr" href="cosmo_fmri_deoblique_hdr.html" />
    <link rel="prev" title="cosmo fmri convert xform hdr" href="cosmo_fmri_convert_xform_hdr.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="cosmo_fmri_deoblique_hdr.html" title="cosmo fmri deoblique hdr"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cosmo_fmri_convert_xform_hdr.html" title="cosmo fmri convert xform hdr"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CoSMoMVPA</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../cimec2016.html" >CIMeC hands-on methods course, part 1 (6 April-2 May 2016)</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../matindex_hdr.html" accesskey="U">CoSMoMVPA functions - header signature files</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cosmo-fmri-dataset-hdr">
<span id="id1"></span><h1>cosmo fmri dataset hdr<a class="headerlink" href="#cosmo-fmri-dataset-hdr" title="Permalink to this headline">Â¶</a></h1>
<div class="highlight-matlab"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>ds<span class="p">=</span><span class="nf">cosmo_fmri_dataset</span><span class="p">(</span>filename, varargin<span class="p">)</span><span class="w"></span>
<span class="c">% load an fmri volumetric dataset</span>
<span class="c">%</span>
<span class="c">% ds = cosmo_fmri_dataset(filename, [,&#39;mask&#39;,mask],...</span>
<span class="c">%                                   [&#39;targets&#39;,targets],...</span>
<span class="c">%                                   [&#39;chunks&#39;,chunks])</span>
<span class="c">%</span>
<span class="c">% Inputs:</span>
<span class="c">%   filename     One of:</span>
<span class="c">%                * filename of fMRI dataset, it should end with one of:</span>
<span class="c">%                   .nii, .nii.gz                   NIfTI</span>
<span class="c">%                   .hdr, .img                      ANALYZE</span>
<span class="c">%                   +{orig,tlrc}.{HEAD,BRIK[.gz]}   AFNI</span>
<span class="c">%                   .vmr, .vmp, .vtc, .glm, .msk    BrainVoyager</span>
<span class="c">%                   .mat                            SPM (SPM.mat)</span>
<span class="c">%                   .mat:beta                       SPM beta</span>
<span class="c">%                   .mat:con                        SPM contrast</span>
<span class="c">%                   .mat:spm                        SPM stats</span>
<span class="c">%                   .mat                            Matlab file with</span>
<span class="c">%                                                   CoSMoMVPA or PyMVPA</span>
<span class="c">%                                                   dataset.</span>
<span class="c">%                * xff structure (from neuroelf&#39;s xff)</span>
<span class="c">%                * nifti structure (from load_untouch_nii)</span>
<span class="c">%                * FieldTrip source MEEG structure</span>
<span class="c">%                * SPM structure</span>
<span class="c">%                * CoSMoMVPA fMRI or MEEG source dataset structure</span>
<span class="c">%                * PyMVPA fMRI dataset structure (exported using PyMVPA&#39;s</span>
<span class="c">%                  cosmo.map2cosmo function)</span>
<span class="c">%   &#39;mask&#39;, m    Any input as for filename (in which case the output must</span>
<span class="c">%                contain a single volume), or one of:</span>
<span class="c">%                   &#39;-all&#39;     exclude features where all values are</span>
<span class="c">%                              zero or NaN</span>
<span class="c">%                   &#39;-any&#39;     exclude features where any value is</span>
<span class="c">%                              zero or NaN</span>
<span class="c">%                   &#39;-auto&#39;    require that &#39;-all&#39; and &#39;-any&#39; exclude the</span>
<span class="c">%                              same features, and exclude the</span>
<span class="c">%                              corresponding features</span>
<span class="c">%                   true       equivalent to &#39;-auto&#39;</span>
<span class="c">%                   false      do not apply a mask</span>
<span class="c">%                The mask must have voxels at the same coordinates as the</span>
<span class="c">%                data indicated by filename, although it may</span>
<span class="c">%                have a different orientation (e.g. RAI, LPI, AIR).</span>
<span class="c">%                Only voxels that are non-zero and not NaN are selected</span>
<span class="c">%                from the data indicated by filename.</span>
<span class="c">%                If &#39;mask&#39; is not given, then no mask is applied and a</span>
<span class="c">%                warning message (suggesting to use a mask) is printed if</span>
<span class="c">%                at least 5% of the values are non{zero,finite}.</span>
<span class="c">%   &#39;targets&#39;, t optional Tx1 numeric labels of experimental</span>
<span class="c">%                conditions (where T is the number of samples (volumes)</span>
<span class="c">%                in the dataset)</span>
<span class="c">%   &#39;chunks, c   optional Tx1 numeric labels of chunks, typically indices</span>
<span class="c">%                of runs of data acquisition</span>
<span class="c">%   &#39;volumes&#39;, v optional vector with indices of volumes to load. If</span>
<span class="c">%                empty or not provided, then all volumes are loaded.</span>
<span class="c">%   &#39;block_size&#39;, b  optional block size by which data is read (if</span>
<span class="c">%                supported by the format; currently NIfTI, ANALYZE, AFNI</span>
<span class="c">%                and SPM. If this option is provided *and* a mask is</span>
<span class="c">%                provided, then data is loaded in chunks (subsets of</span>
<span class="c">%                volumes) that contain at most block_size elements each;</span>
<span class="c">%                only data that survives the mask is then selected before</span>
<span class="c">%                the next block is loaded.</span>
<span class="c">%                The default value is 20,000,000, corresponding to ~160</span>
<span class="c">%                megabytes of memory required for a block (using</span>
<span class="c">%                numbers with double (64 bit) precsision).</span>
<span class="c">%                The rationale for this option is to reduce memory</span>
<span class="c">%                requirements, at the expensive of a possible increase of</span>
<span class="c">%                duration of disk reading operations.</span>
<span class="c">%</span>
<span class="c">%</span>
<span class="c">% Returns:</span>
<span class="c">%   ds           dataset struct with the following fields:</span>
<span class="c">%     .samples   NxM matrix containing the data loaded from filename, for</span>
<span class="c">%                N samples (observations, volumes) and M features (spatial</span>
<span class="c">%                locations, voxels).</span>
<span class="c">%                If the original nifti file contained data with X,Y,Z,T</span>
<span class="c">%                elements in the three spatial and one temporal dimension</span>
<span class="c">%                and no mask was applied, then .samples will have</span>
<span class="c">%                dimensions N x M, where N = T and M = X*Y*Z. If a mask</span>
<span class="c">%                was applied then M (M&lt;=X*Y*Z) is the number of non-zero</span>
<span class="c">%                voxels in the  mask input dataset.</span>
<span class="c">%     .a         struct with dataset-relevent data.</span>
<span class="c">%     .a.fdim.labels   dimension labels, set to {&#39;i&#39;,&#39;j&#39;,&#39;k&#39;}</span>
<span class="c">%     .a.fdim.values   dimension values, set to {1:X, 1:Y, 1:Z}</span>
<span class="c">%     .a.vol.dim 1x3 vector indicating the number of voxels in the 3</span>
<span class="c">%                spatial dimensions.</span>
<span class="c">%     .a.vol.mat 4x4 voxel-to-world transformation matrix (base-1).</span>
<span class="c">%     .a.vol.dim 1x3 number of voxels in each spatial dimension</span>
<span class="c">%     .sa        struct for holding sample attributes (e.g., sa.targets,</span>
<span class="c">%                sa.chunks)</span>
<span class="c">%     .fa        struct for holding feature attributes</span>
<span class="c">%     .fa.{i,j,k} indices of voxels (in voxel space).</span>
<span class="c">%</span>
<span class="c">% Notes:</span>
<span class="c">%  - Most MVPA applications require that .sa.targets (experimental</span>
<span class="c">%    condition of each sample) and .sa.chunks (partitioning of the samples</span>
<span class="c">%    in independent sets) are set, either by using this function or</span>
<span class="c">%    manually afterwards.</span>
<span class="c">%  - Data can be mapped to the volume using cosmo_map2fmri</span>
<span class="c">%  - SPM data can also be specified as filename:format, where format</span>
<span class="c">%    can be &#39;beta&#39;, &#39;con&#39; or &#39;spm&#39; (e.g. &#39;SPM.mat:beta&#39;, &#39;SPM.mat:con&#39;, or</span>
<span class="c">%    &#39;SPM.mat:spm&#39;) to load beta, contrast, or statistic images,</span>
<span class="c">%    respectively. When using &#39;beta&#39;, estimates for motion parameters and</span>
<span class="c">%    intercepts (which in most cases are estimates of no interest) are</span>
<span class="c">%    not returned. If format is omitted it is set to &#39;beta&#39;.</span>
<span class="c">%  - If SPM data contains a field .Sess (session) then .sa.chunks are set</span>
<span class="c">%    according to its contents</span>
<span class="c">%  - If a mask is supplied, then all features that are in the mask are</span>
<span class="c">%    returned, even if some voxels contain NaN. To remove such features,</span>
<span class="c">%    consider applying cosmo_remove_useless_data to the output of this</span>
<span class="c">%    function.</span>
<span class="c">%</span>
<span class="c">% Dependencies:</span>
<span class="c">% -  for NIfTI, analyze (.hdr/.img) and SPM.mat files, it requires the</span>
<span class="c">%    NIfTI toolbox by Jimmy Shen</span>
<span class="c">%    (note that his toolbox is included in CoSMoMVPA in /externals)</span>
<span class="c">% -  for Brainvoyager files (.vmp, .vtc, .msk, .glm), it requires the</span>
<span class="c">%    NeuroElf toolbox, available from: http://neuroelf.net</span>
<span class="c">% -  for AFNI files (+{orig,tlrc}.{HEAD,BRIK[.gz]}) it requires the AFNI</span>
<span class="c">%    Matlab toolbox, available from: https://github.com/afni/AFNI</span>
<span class="c">%</span>
<span class="c">% Examples:</span>
<span class="c">%     % load nifti file</span>
<span class="c">%     ds=cosmo_fmri_dataset(&#39;mydata.nii&#39;);</span>
<span class="c">%</span>
<span class="c">%     % load gzipped nifti file</span>
<span class="c">%     ds=cosmo_fmri_dataset(&#39;mydata.nii.gz&#39;);</span>
<span class="c">%</span>
<span class="c">%     % load ANALYZE file and apply brain mask</span>
<span class="c">%     ds=cosmo_fmri_dataset(&#39;mydata.hdr&#39;,&#39;mask&#39;,&#39;brain_mask.hdr&#39;);</span>
<span class="c">%</span>
<span class="c">%     % load AFNI file with 6 &#39;bricks&#39; (values per voxel, e.g. beta</span>
<span class="c">%     % values); set chunks (e.g. runs) and targets (experimental</span>
<span class="c">%     % conditions); use a mask</span>
<span class="c">%     ds=cosmo_fmri_dataset(&#39;mydata+tlrc&#39;, &#39;chunks&#39;, [1 1 1 2 2 2]&#39;, ...</span>
<span class="c">%                                     &#39;targets&#39;, [1 2 3 1 2 3]&#39;, ...</span>
<span class="c">%                                     &#39;mask&#39;, &#39;masks/brain_mask+tlrc);</span>
<span class="c">%</span>
<span class="c">%     % load BrainVoyager VMR file in directory &#39;mydata&#39;, and apply an</span>
<span class="c">%     % automask that removes all features (voxels) that are zero or</span>
<span class="c">%     % non-finite for all samples</span>
<span class="c">%     ds=cosmo_fmri_dataset(&#39;mydata/mydata.vmr&#39;, &#39;mask&#39;, true);</span>
<span class="c">%</span>
<span class="c">%     % load two datasets, one for odd runs, the other for even runs, and</span>
<span class="c">%     % combine them into one dataset. Note that the chunks are set here,</span>
<span class="c">%     % but the targets are not - for subsequent analyses this may have to</span>
<span class="c">%     % be done manually</span>
<span class="c">%     ds_even=cosmo_fmri_dataset(&#39;data_even_runs.glm&#39;,&#39;chunks&#39;,1);</span>
<span class="c">%     ds_odd=cosmo_fmri_dataset(&#39;data_odd_runs.glm&#39;,&#39;chunks&#39;,2);</span>
<span class="c">%     ds=cosmo_stack({ds_even,ds_odd});</span>
<span class="c">%</span>
<span class="c">%     % load beta values from SPM GLM analysis stored</span>
<span class="c">%     % in a file SPM.mat.</span>
<span class="c">%     % If SPM.mat contains a field .Sess (sessions) then .sa.chunks</span>
<span class="c">%     % is set according to the contents of .Sess.</span>
<span class="c">%     ds=cosmo_fmri_dataset(&#39;path/to/SPM.mat&#39;);</span>
<span class="c">%</span>
<span class="c">%     % as above, and apply an automask to remove voxels that</span>
<span class="c">%     % are zero or non-finite in all samples.</span>
<span class="c">%     ds=cosmo_fmri_dataset(&#39;path/to/SPM.mat&#39;,&#39;mask&#39;,true);</span>
<span class="c">%</span>
<span class="c">%     % load contrast beta values from SPM GLM file SPM.mat</span>
<span class="c">%     ds=cosmo_fmri_dataset(&#39;path/to/SPM.mat:con&#39;);</span>
<span class="c">%</span>
<span class="c">%     % load contrast statistic values from SPM GLM file SPM.mat</span>
<span class="c">%     ds=cosmo_fmri_dataset(&#39;path/to/SPM.mat:spm&#39;);</span>
<span class="c">%</span>
<span class="c">%     % load PyMVPA dataset &#39;pymvpa_ds&#39; that was exported using</span>
<span class="c">%     % PyMVPA&#39;s cosmo.map2cosmo function in Python with:</span>
<span class="c">%     %</span>
<span class="c">%     %    &gt;&gt;&gt; from mvpa2.datasets import cosmo</span>
<span class="c">%     %    &gt;&gt;&gt; cosmo.map2cosmo(pymvpa_ds,&#39;data.mat&#39;)</span>
<span class="c">%     %</span>
<span class="c">%     cosmo_ds=cosmo_fmri_dataset(&#39;data.mat&#39;)</span>
<span class="c">%</span>
<span class="c">% See also: cosmo_map2fmri</span>
<span class="c">%</span>
<span class="c">% part of the NIfTI code is based on code by Robert W Cox, 2003,</span>
<span class="c">% dedicated to the public domain.</span>
<span class="c">%</span>
<span class="c">% #   For CoSMoMVPA&#39;s copyright information and license terms,   #</span>
<span class="c">% #   see the COPYING file distributed with CoSMoMVPA.           #</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/cosmomvpa_logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="cosmo_fmri_convert_xform_hdr.html"
                        title="previous chapter">cosmo fmri convert xform hdr</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="cosmo_fmri_deoblique_hdr.html"
                        title="next chapter">cosmo fmri deoblique hdr</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/matlab/cosmo_fmri_dataset_hdr.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="cosmo_fmri_deoblique_hdr.html" title="cosmo fmri deoblique hdr"
             >next</a> |</li>
        <li class="right" >
          <a href="cosmo_fmri_convert_xform_hdr.html" title="cosmo fmri convert xform hdr"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CoSMoMVPA</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../cimec2016.html" >CIMeC hands-on methods course, part 1 (6 April-2 May 2016)</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../matindex_hdr.html" >CoSMoMVPA functions - header signature files</a> &#187;</li> 
      </ul>
    </div>
      <div class="footer">
       <span class="creativecommons">
          <a href="http://opensource.org/licenses/MIT" >
          <img src="../_static/mit-license_logo.png"
               border="0" alt="Creative Commons License"/>
         </a> 
         
        <a href="copyright.html">Copyright 2013-2016 Nikolaas N. Oosterhof, Andrew C. Connolly, CoSMoMVPA contributors</a>.
        CoSMoMVPA is licensed under a <a href="http://opensource.org/licenses/MIT">Expat (MIT) License</a>.
       </span>
      </div>
  </body>
</html>
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CoSMoMVPA concepts &#8212; CoSMo Multivariate Pattern Analysis toolbox 1.0rc1 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0rc1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="next" title="Documentation" href="documentation.html" />
    <link rel="prev" title="Multivariate pattern analysis" href="mvpa_concepts.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="documentation.html" title="Documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mvpa_concepts.html" title="Multivariate pattern analysis"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CoSMoMVPA</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="get_started.html" accesskey="U">Get Started</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cosmomvpa-concepts">
<span id="id1"></span><h1><a class="toc-backref" href="#id10">CoSMoMVPA concepts</a><a class="headerlink" href="#cosmomvpa-concepts" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#cosmomvpa-concepts" id="id10">CoSMoMVPA concepts</a><ul>
<li><a class="reference internal" href="#dataset" id="id11">Dataset</a></li>
<li><a class="reference internal" href="#dataset-operations" id="id12">Dataset operations</a></li>
<li><a class="reference internal" href="#classifier" id="id13">Classifier</a></li>
<li><a class="reference internal" href="#measure" id="id14">Measure</a></li>
<li><a class="reference internal" href="#neighborhood" id="id15">Neighborhood</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="dataset">
<span id="cosmomvpa-dataset"></span><h2><a class="toc-backref" href="#id11">Dataset</a><a class="headerlink" href="#dataset" title="Permalink to this headline">¶</a></h2>
<p>Given the general formulation of <a class="reference internal" href="mvpa_concepts.html#mvpa-concepts"><span class="std std-ref">patterns</span></a> as used in MVPA, this section will describe a framework that can be used to to MVPA in Matlab easily. Inspired by <a class="reference external" href="http://pymvpa.org">PyMVPA</a>, the matrix representation of patterns is expanded to form the concept of a <em>Dataset</em>, which contains:</p>
<blockquote>
<div><ul class="simple">
<li>a sample-by-feature data matrix.</li>
<li>sample attributes: attributes for each sample (row) in the data matrix.</li>
<li>feature attributes: attributes for each feature (column) in the data matrix.</li>
<li>dataset attributes: general attributes that are not linked specifically to samples or features.</li>
</ul>
</div></blockquote>
<p>In analogy with a table with data, the sample attributes can be seen as the row headers and the feature attributes as the column headers. However, each sample and feature (i.e. row and column) can have multiple attributes associated with them.</p>
<p>For example, an fMRI dataset in CoSMoMVPA can be visualized as follows:</p>
<div class="figure">
<img alt="_images/cosmo_dataset.png" src="_images/cosmo_dataset.png" />
</div>
<p>A more detailed explanation is provided below.</p>
<div class="section" id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h3>
<p>Just the data in the sample-by-feature data matrix not sufficient to be able to perform analyses; typically one needs additional descriptors (or attributes) indicating what a sample or feature represents. In the Dataset representation used in CoSMoMVPA, there are three types of attributes:</p>
<div class="section" id="sample-attributes">
<h4>Sample attributes<a class="headerlink" href="#sample-attributes" title="Permalink to this headline">¶</a></h4>
<p>Sample attributes ontain information about each sample (and is the same across all features), and are stored in a field <code class="docutils literal"><span class="pre">.sa</span></code>. Most MVPA requires at least the following two sample attributes:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">.sa.targets</span></code>: represent the class of each sample. In the fMRI example above, these would be the category of the stimulus (monkeys, lemurs, ladybugs or lunamoths). In CoSMoMVPA, these are represented numerically; for example, 1=monkey, 2=lemur, 3=ladybug, 4=lunamoth).</li>
<li><code class="docutils literal"><span class="pre">.sa.chunks</span></code>: samples with the same chunks represent a group of samples that is acquired &#8216;independently&#8217; from samples in other chunks. Independently is hard to define precisely, but in fMRI it usually refers to a single run of acquisition. In the fMRI example above, there are 10 chunks, each with 4 samples. In a take-one-out cross-validation analysis, for example, one tests a classifier on the samples in one chunk after it has been trained on the samples in the remaining chunks.</li>
</ul>
<p>Note that in the example here there is a third sample attribute, <code class="docutils literal"><span class="pre">.sa.labels</span></code>, which is a cell containing human-readable descriptions of each sample.</p>
</div></blockquote>
</div>
<div class="section" id="feature-attributes">
<h4>Feature attributes<a class="headerlink" href="#feature-attributes" title="Permalink to this headline">¶</a></h4>
<p>Feature attributes contain information about each feature (and is the same across all samples), and are stored in a field <code class="docutils literal"><span class="pre">.fa</span></code>. These are optional in principal, but in most use cases these are used to specify information where the feature came from.</p>
<blockquote>
<div><ul class="simple">
<li>in fMRI: the voxel indices associated with each feature. With three spatial dimensions each feature is associated with three indices, <code class="docutils literal"><span class="pre">.fa.i</span></code>, <code class="docutils literal"><span class="pre">.fa.j</span></code>, and <code class="docutils literal"><span class="pre">.fa.k</span></code>.</li>
<li>in MEEG: the indices of SQUID sensor, time-point, or frequency band. For example, data transformed to time-frequency space has three feature attributes: <code class="docutils literal"><span class="pre">.fa.chan</span></code>, <code class="docutils literal"><span class="pre">.fa.time</span></code>, and <code class="docutils literal"><span class="pre">.fa.freq</span></code>.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="dataset-attributes">
<h4>Dataset attributes<a class="headerlink" href="#dataset-attributes" title="Permalink to this headline">¶</a></h4>
<p>Dataset attributes contain general information about the whole dataset.</p>
<blockquote>
<div><p>In fMRI these are typically:</p>
<ul class="simple">
<li>A <code class="docutils literal"><span class="pre">.a.vol</span></code> field containing information about the voxel-to-world mapping. This is required to map the spatial location of each voxel from <cite>voxel coordinates</cite> (integer indices) to <cite>world coordinates</cite> (metric units, typically milimeters). Currently this is stored in a 4x4 <code class="docutils literal"><span class="pre">.a.vol.mat</span></code>  affine transformation matrix that follows the <code class="docutils literal"><span class="pre">LPI</span></code> (left-to-right, posterior-to-anterior, inferior-to-superior) convention (non-affine transformations are currently not supported).</li>
<li>The range of indices used in <code class="docutils literal"><span class="pre">.fa.i</span></code>, <code class="docutils literal"><span class="pre">.fa.j</span></code> and <code class="docutils literal"><span class="pre">.fa.k</span></code>, stored in <code class="docutils literal"><span class="pre">.a.fdim.values</span></code>.</li>
<li>The names of the spatial feature attributes, stored in <code class="docutils literal"><span class="pre">.a.fdim.labels</span></code>.</li>
</ul>
<p>In MEEG these are, for a dataset with data in time-frequency space:</p>
<ul class="simple">
<li>The names of the feature attribtues (<code class="docutils literal"><span class="pre">chan</span></code>, <code class="docutils literal"><span class="pre">time</span></code>, and <code class="docutils literal"><span class="pre">freq</span></code>), stored in <code class="docutils literal"><span class="pre">.a.fdim.labels</span></code> .</li>
<li>channel names are stored in the field <code class="docutils literal"><span class="pre">.a.fdim.values{1}</span></code>, time-points in <code class="docutils literal"><span class="pre">.a.fdim.values{2}</span></code>, and frequencies in <code class="docutils literal"><span class="pre">.a.fdim.values{3}</span></code>. In such a dataset, the feature attribute <code class="docutils literal"><span class="pre">.fa.chan</span></code>, <code class="docutils literal"><span class="pre">.fa.time</span></code>, and <code class="docutils literal"><span class="pre">.fa.freq</span></code>, contain integers that index the corresponding elements in <code class="docutils literal"><span class="pre">.a.fdim.values</span></code>.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="targets">
<span id="cosmomvpa-targets"></span><h3>Targets<a class="headerlink" href="#targets" title="Permalink to this headline">¶</a></h3>
<p>The example above showed the sample attribute <code class="docutils literal"><span class="pre">targets</span></code>, and its use is not by accident. As for almost all MVPA applications one is interested in the (dis)similarity of patterns within and across <em>conditions of interest</em>, these should be stored in the dataset. Here, conditions of interest is typically defined by the experimental paradigm, for example:</p>
<blockquote>
<div><ul class="simple">
<li>category of visual stimulus: house, face, or human body.</li>
<li>effector involved in movement planning: left hand or right hand.</li>
<li>whether a peri-threshold auditory stimulus was perceived: yes or no.</li>
</ul>
</div></blockquote>
<p>In <a class="reference external" href="http://cosmomvpa.org">CoSMoMVPA</a> these conditions are coded in a special <em>sample attribute</em> called <em>targets</em>, i.e. in a dataset <code class="docutils literal"><span class="pre">ds</span></code> they are in <code class="docutils literal"><span class="pre">ds.sa.targets</span></code>. They should be coded as integer values in a <code class="docutils literal"><span class="pre">Px1</span></code> vector, where <code class="docutils literal"><span class="pre">P</span></code> is the number of samples.</p>
</div>
<div class="section" id="chunks">
<span id="cosmomvpa-chunks"></span><h3>Chunks<a class="headerlink" href="#chunks" title="Permalink to this headline">¶</a></h3>
<p>Another sample attribute illustrated above (that is also important for most MVPA applications) is the concept of <em>chunks</em>. Here, a <em>chunk</em> is meant to indicate a set of samples that can be considered <strong>independent</strong> from samples in other chunks, whereas samples within a chunk are not necessarily independent.</p>
<p>Independence is crucial here, because many core MVP analyses assess generalizability of pattern properties of a subset of chunks to another disjoint subset of chunks. For example:</p>
<blockquote>
<div><ul class="simple">
<li>in split-half correlation analysis, the data is split in two and each half assigned to a different chunk, yielding two chunks. A typical application is computing &#8216;on-diagonal&#8217; vs &#8216;off-diagonal&#8217; correlations, i.e. the difference of pattern correlations of the same target versus other targets.</li>
<li>in an <code class="docutils literal"><span class="pre">n</span></code>-fold cross-validation scheme, the data is split in <code class="docutils literal"><span class="pre">n</span></code> chunks. A typical application is cross-validated classification, where a classifier is tested on one chunk after being trained on the remaining chunks.</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>Typical chunk assignments are:</dt>
<dd><ul class="first last simple">
<li>in fMRI studies: each run (period of continuous recording) gives rise to a single chunk. Putting samples in a single run in different chunks may violate the independency assumption because of the slow-ness of the BOLD response, unless samples are seperated by a considerable time interval.</li>
<li>in MEEG studies: if trials can be assumed to be independent (which most people in MEEG studies seem to do), then chunks can be assigned randomly (or in a systematic order). This can be done pseudo-randomly using <a class="reference internal" href="matlab/cosmo_chunkize.html#cosmo-chunkize"><span class="std std-ref">cosmo chunkize</span></a>. If the indendency assumption cannot be fullfilled then chunks should be assigned on a run-by-run basis.</li>
</ul>
</dd>
</dl>
<p>As with <em>targets</em> above, <em>chunks</em> should be coded as integer values in a <code class="docutils literal"><span class="pre">Px1</span></code> vector, where <code class="docutils literal"><span class="pre">P</span></code> is the number of samples.</p>
</div>
<div class="section" id="samples-sample-attributes-feature-attributes-dataset-attributes-dataset">
<h3>Samples + sample attributes + feature attributes + dataset attributes = dataset<a class="headerlink" href="#samples-sample-attributes-feature-attributes-dataset-attributes-dataset" title="Permalink to this headline">¶</a></h3>
<p>Taken the above together, a CoSMoMVPA dataset contains four ingredients: &#8216;samples&#8217; (the sample x features data matrix), &#8216;sample attributes&#8217;, &#8216;feature attributes&#8217;, and &#8216;dataset attributes&#8217;. These are implemented, in Matlab, using a <code class="docutils literal"><span class="pre">struct</span></code>, with fields <code class="docutils literal"><span class="pre">.samples</span></code>, <code class="docutils literal"><span class="pre">.sa</span></code>, <code class="docutils literal"><span class="pre">.fa</span></code>, and <code class="docutils literal"><span class="pre">.a</span></code>. For example an fMRI dataset can be instantiated using <a class="reference internal" href="matlab/cosmo_fmri_dataset.html#cosmo-fmri-dataset"><span class="std std-ref">cosmo fmri dataset</span></a> and might contain:</p>
<p><code class="docutils literal"><span class="pre">.samples</span></code>,</p>
<blockquote>
<div><div class="highlight-matlab"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mf">0.568</span>       <span class="mf">3.9</span>      <span class="mf">4.11</span>  <span class="c">...   0.732     0.473      2.37</span>
   <span class="mf">1.45</span>      <span class="mf">3.71</span>      <span class="mf">4.86</span>  <span class="c">...  -0.265     0.846     0.544</span>
   <span class="mf">2.23</span>      <span class="mf">1.31</span>      <span class="mf">2.76</span>  <span class="c">...   0.314     0.485    -0.335</span>
    <span class="p">:</span>         <span class="p">:</span>         <span class="p">:</span>            <span class="p">:</span>        <span class="p">:</span>          <span class="p">:</span>
   <span class="mf">2.06</span>      <span class="mf">1.46</span>      <span class="mf">3.52</span>  <span class="c">...  -0.162  -0.00311     0.488</span>
  <span class="mf">0.596</span>      <span class="mf">1.96</span>      <span class="mf">3.93</span>  <span class="c">...   0.147      1.16      3.14</span>
  <span class="o">-</span><span class="mf">1.35</span>     <span class="mf">0.511</span>    <span class="o">-</span><span class="mf">0.116</span>  <span class="c">...  -0.628     0.756     0.628 ]@40x298</span>
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">.sa</span></code>,</p>
<blockquote>
<div><div class="highlight-matlab"><div class="highlight"><pre><span></span><span class="p">.</span><span class="n">targets</span>
  <span class="p">[</span> <span class="mi">1</span>
    <span class="mi">2</span>
    <span class="mi">3</span>
    <span class="p">:</span>
    <span class="mi">2</span>
    <span class="mi">3</span>
    <span class="mi">4</span> <span class="p">]@</span><span class="mi">40</span><span class="n">x1</span>
<span class="p">.</span><span class="n">chunks</span>
  <span class="p">[</span>  <span class="mi">1</span>
     <span class="mi">1</span>
     <span class="mi">1</span>
     <span class="p">:</span>
    <span class="mi">10</span>
    <span class="mi">10</span>
    <span class="mi">10</span> <span class="p">]@</span><span class="mi">40</span><span class="n">x1</span>
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">.fa</span></code>,</p>
<blockquote>
<div><div class="highlight-matlab"><div class="highlight"><pre><span></span><span class="p">.</span><span class="nb">i</span>
  <span class="p">[</span> <span class="mi">44</span>        <span class="mi">42</span>        <span class="mi">43</span>  <span class="c">...  43        40        41 ]@1x298</span>
<span class="p">.</span><span class="nb">j</span>
  <span class="p">[</span> <span class="mi">15</span>        <span class="mi">15</span>        <span class="mi">15</span>  <span class="c">...  16        19        19 ]@1x298</span>
<span class="p">.</span><span class="n">k</span>
  <span class="p">[</span> <span class="mi">3</span>         <span class="mi">4</span>         <span class="mi">4</span>  <span class="c">...  13        13        13 ]@1x298</span>
</pre></div>
</div>
</div></blockquote>
<p>and <code class="docutils literal"><span class="pre">.a</span></code>:</p>
<blockquote>
<div><div class="highlight-matlab"><div class="highlight"><pre><span></span><span class="p">.</span><span class="n">fdim</span>
  <span class="p">.</span><span class="n">labels</span>
    <span class="p">{</span> <span class="s">&#39;i&#39;</span>  <span class="s">&#39;j&#39;</span>  <span class="s">&#39;k&#39;</span> <span class="p">}</span>
  <span class="p">.</span><span class="n">values</span>
    <span class="p">{</span> <span class="p">[</span> <span class="mi">1</span>         <span class="mi">2</span>         <span class="mi">3</span>  <span class="c">...  78        79        80 ]@1x80  [ 1         2         3  ...  78        79        80 ]@1x80  [ 1         2         3  ...  41        42        43 ]@1x43 }</span>
<span class="p">.</span><span class="n">vol</span>
  <span class="p">.</span><span class="n">mat</span>
    <span class="p">[</span> <span class="mi">3</span>         <span class="mi">0</span>         <span class="mi">0</span>      <span class="o">-</span><span class="mi">122</span>
      <span class="mi">0</span>         <span class="mi">3</span>         <span class="mi">0</span>      <span class="o">-</span><span class="mi">114</span>
      <span class="mi">0</span>         <span class="mi">0</span>         <span class="mi">3</span>     <span class="o">-</span><span class="mf">11.1</span>
      <span class="mi">0</span>         <span class="mi">0</span>         <span class="mi">0</span>         <span class="mi">1</span> <span class="p">]</span>
  <span class="p">.</span><span class="n">dim</span>
    <span class="p">[</span> <span class="mi">80</span>        <span class="mi">80</span>        <span class="mi">43</span> <span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
<p>In this case there are M=40 samples and N=298 features (voxels). Note that the sample attributes have M values in the first dimension, and feature attributes have N values in the second dimension. The information in the <code class="docutils literal"><span class="pre">.fa</span></code> and <code class="docutils literal"><span class="pre">.a</span></code> fields is used when the dataset is back to a volumetric dataset in <a class="reference internal" href="matlab/cosmo_map2fmri.html#cosmo-map2fmri"><span class="std std-ref">cosmo map2fmri</span></a>.</p>
</div>
</div>
<div class="section" id="dataset-operations">
<span id="cosmomvpa-dataset-operations"></span><h2><a class="toc-backref" href="#id12">Dataset operations</a><a class="headerlink" href="#dataset-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="slicing">
<h3>Slicing<a class="headerlink" href="#slicing" title="Permalink to this headline">¶</a></h3>
<p>Slicing refers to selecting data in a dataset struct, either along the rows or columns. It is provided by the <a class="reference internal" href="matlab/cosmo_slice.html#cosmo-slice"><span class="std std-ref">cosmo slice</span></a> function, which takes three arguments: the dataset <code class="docutils literal"><span class="pre">ds</span></code>, indices or a mask indicating what <code class="docutils literal"><span class="pre">to_select</span></code>, and a <code class="docutils literal"><span class="pre">dim</span></code> argument indicating whether to slice along rows or colums.</p>
<ul>
<li><p class="first">Slicing samples (<code class="docutils literal"><span class="pre">dim=1</span></code>; this is the default value) means that the specified <em>rows</em> are selected, both in <code class="docutils literal"><span class="pre">.samples</span></code> and each field in <code class="docutils literal"><span class="pre">.sa</span></code> (such as <code class="docutils literal"><span class="pre">.sa.targets</span></code> and <code class="docutils literal"><span class="pre">.sa.chunks</span></code>).</p>
<blockquote>
<div><p>Use cases include:</p>
<ul>
<li><p class="first">Select only samples for certain conditions (targets)</p>
</li>
<li><p class="first">Select only samples in certain chunks; this is useful for:</p>
<blockquote>
<div><ul class="simple">
<li>cross-validation: data is tested using data in, say, one chunk after training on data in the remaining chunks (see <a class="reference internal" href="matlab/cosmo_nfold_partitioner.html#cosmo-nfold-partitioner"><span class="std std-ref">cosmo nfold partitioner</span></a> and <a class="reference internal" href="matlab/cosmo_nchoosek_partitioner.html#cosmo-nchoosek-partitioner"><span class="std std-ref">cosmo nchoosek partitioner</span></a>).</li>
<li>split-half correlations: when half of the data (in one (set of) chunks) is correlated with data in the other half (see <a class="reference internal" href="matlab/cosmo_oddeven_partitioner.html#cosmo-oddeven-partitioner"><span class="std std-ref">cosmo oddeven partitioner</span></a> and <cite>cosmo_correlation_measure</cite>).</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="figure" id="id7">
<img alt="_images/slice_sa.png" src="_images/slice_sa.png" />
<p class="caption"><span class="caption-text">Illustration of slicing rows (samples). In the masks, white elements are selected and black elements are not selected.</span></p>
</div>
<ul>
<li><p class="first">Slicing features (<code class="docutils literal"><span class="pre">dim=2</span></code>) means that the specified <em>columns</em> are selected, both in <code class="docutils literal"><span class="pre">.samples</span></code> and each field in <code class="docutils literal"><span class="pre">.fa</span></code> (such as <code class="docutils literal"><span class="pre">.fa.i</span></code>, <code class="docutils literal"><span class="pre">fa.j</span></code> and <code class="docutils literal"><span class="pre">fa.k</span></code> in an fMRI-dataset, which indicate the voxel indices). Use cases include:</p>
<blockquote>
<div><ul class="simple">
<li>Select only certain voxels in a region of interest</li>
<li>Running a searchlight, which consists of doing the analyses many regions of interest.</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="figure" id="id8">
<img alt="_images/slice_fa.png" src="_images/slice_fa.png" />
<p class="caption"><span class="caption-text">Illustration of slicing columns (features). In the masks, white elements are selected and black elements are not selected.</span></p>
</div>
</div>
<div class="section" id="slicing-related-functions">
<h3>Slicing-related functions<a class="headerlink" href="#slicing-related-functions" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Related functions are:</dt>
<dd><ul class="first last">
<li><p class="first"><a class="reference internal" href="matlab/cosmo_split.html#cosmo-split"><span class="std std-ref">cosmo split</span></a> splits datasets along one or more attributes (such as <code class="docutils literal"><span class="pre">.sa.chunks</span></code> and <code class="docutils literal"><span class="pre">.sa.targets</span></code>).</p>
</li>
<li><p class="first"><a class="reference internal" href="matlab/cosmo_stack.html#cosmo-stack"><span class="std std-ref">cosmo stack</span></a> stacks dataset along the first or second dimension. In a way it is the inverse of ;ref:<cite>cosmo_split</cite>, but it can also be used to stack other sets of datasets. A typical use case is:</p>
<blockquote>
<div><ul class="simple">
<li>Use <code class="docutils literal"><span class="pre">cosmo_slice</span></code> or <code class="docutils literal"><span class="pre">cosmo_split</span></code> to select subsets of the data, for example based on each unique combination of <code class="docutils literal"><span class="pre">.sa.chunks</span></code> and/or <code class="docutils literal"><span class="pre">.sa.targets</span></code>.</li>
<li>Perform a certain operation on each subset ot the data, such as computing the mean (averaging) or subtracting the mean (normalization), and store the output for each subset</li>
<li>Join the output of each subset using <code class="docutils literal"><span class="pre">cosmo_stack</span></code>.</li>
</ul>
<p>For example, this <a class="reference internal" href="matlab/run_demean.html#run-demean"><span class="std std-ref">code</span></a> uses <code class="docutils literal"><span class="pre">cosmo_split</span></code> and <code class="docutils literal"><span class="pre">cosmo_stack</span></code> to subtract the mean (across samples) for each unique chunk seperately.</p>
</div></blockquote>
</li>
<li><p class="first"><a class="reference internal" href="matlab/cosmo_fx.html#cosmo-fx"><span class="std std-ref">cosmo fx</span></a> splits the dataset using <a class="reference internal" href="matlab/cosmo_split.html#cosmo-split"><span class="std std-ref">cosmo split</span></a>, applies a function to each element, and stacks the results. It can be used to average data for each value of <code class="docutils literal"><span class="pre">.sa.targets</span></code> seperately, for each unique value of <code class="docutils literal"><span class="pre">.sa.chunks</span></code>, or for each unique combination of <code class="docutils literal"><span class="pre">.sa.targets</span></code> and <code class="docutils literal"><span class="pre">.sa.chunks</span></code>.</p>
</li>
</ul>
</dd>
</dl>
<div class="figure" id="id9">
<img alt="_images/split_and_stack.png" src="_images/split_and_stack.png" />
<p class="caption"><span class="caption-text">Illustration of splitting and stacking rows (samples).</span></p>
</div>
</div>
</div>
<div class="section" id="classifier">
<span id="cosmomvpa-classifier"></span><h2><a class="toc-backref" href="#id13">Classifier</a><a class="headerlink" href="#classifier" title="Permalink to this headline">¶</a></h2>
<p>A classifier takes a <em>training</em> set of patterns, each with a target (class label) associated with them, and a <em>test</em> set of patterns, that have no targets associated with them. The patterns in the train and test set should be from disjoint sets of chunks, otherwise circular analysis will ensue (which is a Bad Thing).</p>
<p>In CoSMoMVPA, all classifiers use the same signature:</p>
<blockquote>
<div><div class="highlight-matlab"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>predicted <span class="p">=</span><span class="w"> </span><span class="nf">cosmo_classify_lda</span><span class="p">(</span>samples_train, targets_train, samples_test, opt<span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div></blockquote>
<p>where the inputs are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">samples_train</span></code> is a <code class="docutils literal"><span class="pre">PxR</span></code> matrix for <code class="docutils literal"><span class="pre">P</span></code> samples and <code class="docutils literal"><span class="pre">R</span></code> features (i.e. it contains <code class="docutils literal"><span class="pre">P</span></code> patterns).</li>
<li><code class="docutils literal"><span class="pre">targets_train</span></code> a <code class="docutils literal"><span class="pre">Px1</span></code> class label vector for each pattern in <code class="docutils literal"><span class="pre">samples_train</span></code>.</li>
<li><code class="docutils literal"><span class="pre">samples_test</span></code> is a <code class="docutils literal"><span class="pre">QxR</span></code> matrix with <code class="docutils literal"><span class="pre">Q</span></code> patterns, with no class labels associated</li>
<li><code class="docutils literal"><span class="pre">opt</span></code> is an optional struct may contain specific options to be used with a specific classifier.</li>
</ul>
</div></blockquote>
<p>The output <code class="docutils literal"><span class="pre">predicted</span></code> is a <code class="docutils literal"><span class="pre">Qx1</span></code> vector containing the predicted class labels for each sample in <code class="docutils literal"><span class="pre">samples_test</span></code>. Classification accuracy can be computed by considering how many samples in the test set were predicted, and this can be compared to what may be expected by chance. In the simple case where each chunk contains the same number of <em>n</em> samples in each class, chance accuracy is <em>1/n</em>. For MEEG datasets typically the number of samples in each class is not equal; the function <a class="reference internal" href="matlab/cosmo_balance_partitions.html#cosmo-balance-partitions"><span class="std std-ref">cosmo balance partitions</span></a> can be used to accomplish this.</p>
<p>Examples of classifiers are <a class="reference internal" href="matlab/cosmo_classify_nn.html#cosmo-classify-nn"><span class="std std-ref">cosmo classify nn</span></a>, <a class="reference internal" href="matlab/cosmo_classify_svm.html#cosmo-classify-svm"><span class="std std-ref">cosmo classify svm</span></a>, <a class="reference internal" href="matlab/cosmo_classify_lda.html#cosmo-classify-lda"><span class="std std-ref">cosmo classify lda</span></a>, and <a class="reference internal" href="matlab/cosmo_classify_naive_bayes.html#cosmo-classify-naive-bayes"><span class="std std-ref">cosmo classify naive bayes</span></a>.</p>
<p>A classifier is typically used to test how well data in a subset of the data generalizes to another, disjoint, subset of the data. Usually this is done by taking some chunks as a test set, and use the remaining classes as a training set; by repeating this process, each time taking different chunks to form the test set, one or more predictions can be made for each sample in a dataset. Dividing up a dataset in pairs of training and test sets is called <em>partitioning</em>, which is facilitated using <a class="reference internal" href="matlab/cosmo_nchoosek_partitioner.html#cosmo-nchoosek-partitioner"><span class="std std-ref">cosmo nchoosek partitioner</span></a> , and its special case, <a class="reference internal" href="matlab/cosmo_nfold_partitioner.html#cosmo-nfold-partitioner"><span class="std std-ref">cosmo nfold partitioner</span></a>. A classifier can be used for cross-validation using <a class="reference internal" href="matlab/cosmo_crossvalidate.html#cosmo-crossvalidate"><span class="std std-ref">cosmo crossvalidate</span></a>, or (see below), using a more abstract measure <a class="reference internal" href="matlab/cosmo_crossvalidation_measure.html#cosmo-crossvalidation-measure"><span class="std std-ref">cosmo crossvalidation measure</span></a>.</p>
<p>Note that, unless a <a class="reference internal" href="#cosmomvpa-measure"><span class="std std-ref">measure</span></a>, classifier functions are rather bare-bone as data structure; they do not operate on a dataset <code class="docutils literal"><span class="pre">struct</span></code> directly.</p>
</div>
<div class="section" id="measure">
<span id="cosmomvpa-measure"></span><h2><a class="toc-backref" href="#id14">Measure</a><a class="headerlink" href="#measure" title="Permalink to this headline">¶</a></h2>
<p>A dataset measure is a function with the following signature:</p>
<blockquote>
<div><div class="highlight-matlab"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="p">=</span> <span class="n">dataset_measure</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>where <code class="docutils literal"><span class="pre">dataset</span></code> is a dataset of interest, and <code class="docutils literal"><span class="pre">args</span></code> are options specific for that measure. A measure can then be applied to either a dataset directly, or in combination with  a &#8216;searchlight&#8217; where the measure is applied to each searchlight seperately. The output should be a <code class="docutils literal"><span class="pre">struct</span></code> with fields <code class="docutils literal"><span class="pre">.samples</span></code> (in column vector format) and optionally a field <code class="docutils literal"><span class="pre">.sa</span></code> - but no fields <code class="docutils literal"><span class="pre">.fa</span></code> and usually no field <code class="docutils literal"><span class="pre">.a</span></code> (except for a possible <code class="docutils literal"><span class="pre">.a.sdim</span></code> field, if the measure returns data in a dimensional format) .</p>
<p>For example, the following code defines a &#8216;measure&#8217; that returns classification accuracy based ona support vector machine classifier that uses n-fold cross-validation. The measure is then used in a searchlight with a radius of 3 voxels; the input is an fMRI dataset <code class="docutils literal"><span class="pre">ds</span></code> with chunks and targets set, the output an fMRI dataset with one sample containing classification accuracies.</p>
<blockquote>
<div><div class="highlight-matlab"><div class="highlight"><pre><span></span><span class="n">nbrhood</span> <span class="p">=</span> <span class="n">cosmo_spherical_neighborhood</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="s">&#39;radius&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">cv</span> <span class="p">=</span> <span class="p">@</span><span class="n">cosmo_crossvalidation_measure</span><span class="p">;</span>
<span class="n">cv_args</span> <span class="p">=</span> <span class="n">struct</span><span class="p">();</span>
<span class="n">cv_args</span><span class="p">.</span><span class="n">classifier</span> <span class="p">=</span> <span class="p">@</span><span class="n">cosmo_classify_lda</span><span class="p">;</span>
<span class="n">cv_args</span><span class="p">.</span><span class="n">partitions</span> <span class="p">=</span> <span class="n">cosmo_nfold_partitioner</span><span class="p">(</span><span class="n">ds</span><span class="p">);</span>
<span class="n">sl_dset</span> <span class="p">=</span> <span class="n">cosmo_searchlight</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="n">nbrhood</span><span class="p">,</span><span class="n">cv</span><span class="p">,</span><span class="n">cv_args</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>Using classifiers and measures in such an abstract way is a powerful approach to implement new analyses. Any function you write can be used as a dataset measure as long as it uses the dataset measure input scheme, and can directly be used with (for example) a searchlight. When running a searchlight (<a class="reference internal" href="matlab/cosmo_searchlight.html#cosmo-searchlight"><span class="std std-ref">cosmo searchlight</span></a>) with a <a class="reference internal" href="#cosmomvpa-neighborhood">cosmomvpa_neighborhood</a> (see above), data from <code class="docutils literal"><span class="pre">.fa</span></code> and <code class="docutils literal"><span class="pre">.a</span></code> from the neighborhood are combined with the <code class="docutils literal"><span class="pre">.samples</span></code> and <code class="docutils literal"><span class="pre">.sa</span></code> output from the measure to form a full dataset structure with fields <code class="docutils literal"><span class="pre">.samples</span></code>, <code class="docutils literal"><span class="pre">.sa</span></code>, <code class="docutils literal"><span class="pre">.fa</span></code>, and <code class="docutils literal"><span class="pre">.a</span></code>.</p>
<p>Examples of measures include:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="matlab/cosmo_correlation_measure.html#cosmo-correlation-measure"><span class="std std-ref">split-half correlation</span></a>.</li>
<li><a class="reference internal" href="matlab/cosmo_crossvalidation_measure.html#cosmo-crossvalidation-measure"><span class="std std-ref">classification with cross-validation</span></a>.</li>
<li><a class="reference internal" href="matlab/cosmo_dissimilarity_matrix_measure.html#cosmo-dissimilarity-matrix-measure"><span class="std std-ref">representational similarity analysis</span></a>.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="neighborhood">
<span id="searchlight"></span><span id="cosmomvpa-neighborhood"></span><h2><a class="toc-backref" href="#id15">Neighborhood</a><a class="headerlink" href="#neighborhood" title="Permalink to this headline">¶</a></h2>
<p>The tradional (volume-based fMRI) searchlight was introduced <a class="reference internal" href="references.html#kgb06" id="id2">[KGB06]</a> as a method to measure information content <em>locally</em> in the whole brain. In this approach, a sphere-shaped mask (usually with a radius of a few voxels) &#8216;travels&#8217; through the brain, and at each location <a class="reference internal" href="#cosmomvpa-measure"><span class="std std-ref">measures</span></a> information content (such as correlation differences or classification accuracies). This process is done for each brain location, and the result assigned to the center voxel of each sphere. The result is an <em>information</em> (rather than univariate <em>activation</em>) map.</p>
<p><a class="reference external" href="http://cosmomvpa.org">CoSMoMVPA</a> overloads the <em>searchlight</em> concept through a more versatile <em>neighborhood</em> concept. A neighborhood definition describes a mapping that associates with each feature in the <em>target</em> domain (for the output) a set of features in the <em>source</em> domain (from the input). Neighborhoods are used for searchlight analyses (<a class="reference internal" href="matlab/cosmo_searchlight.html#cosmo-searchlight"><span class="std std-ref">cosmo searchlight</span></a>), where the concept of a traditional fMRI volumetric searchlight is generalized to other types of datasets as well. For example:</p>
<blockquote>
<div><ul class="simple">
<li>for a traditional volume-based fMRI searchlight, the features in the source and target domain are the same, and consist of the voxels.</li>
<li>for a surface-based fMRI searchlight, the features in the source domain are the voxels in the volume, whereas the features in the target domain are the nodes on the surface.</li>
<li>for an MEG-based searchlight with magnetometers in the time-locked domain, the source and target domain are the set of all combinations of magnetometers and time points.</li>
<li>for an MEG-based searchlight with planar gradiometers (<code class="docutils literal"><span class="pre">meg_planar</span></code>) but with output as combined (<code class="docutils literal"><span class="pre">meg_combined_from_planar</span></code>) sensors, sensors in the source domain are the planar gradiometers and sensors in the target domain are the combined sensors.</li>
</ul>
</div></blockquote>
<p>A neighborhood is a <code class="docutils literal"><span class="pre">struct</span></code> with fields:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">.neighbors</span></code>: an <code class="docutils literal"><span class="pre">Nx1</span></code> cell for N neighborhoods, where <code class="docutils literal"><span class="pre">.neighbors{k}</span></code> is a vector with features indices in the <em>source</em> domain associated with the <code class="docutils literal"><span class="pre">k</span></code>-th neighborhood.</li>
<li>(optional) <code class="docutils literal"><span class="pre">.fa</span></code> the feature attributes for the target domain. Each field element <code class="docutils literal"><span class="pre">.fa.field</span></code> should have <code class="docutils literal"><span class="pre">N</span></code> elements in the second (i.e. feature) dimension.</li>
<li>(optional) <code class="docutils literal"><span class="pre">.a</span></code> the dataset attributes for the target domain.</li>
<li>(optional) <code class="docutils literal"><span class="pre">.origin</span></code>, with subfields <code class="docutils literal"><span class="pre">.a</span></code> and <code class="docutils literal"><span class="pre">.fa</span></code>, with attributes in the source domain. If present, this information is used when a neighborhood is applied to a dataset: if they do not match the attributes, an error is thrown. This can help in accidentally using the wrong neighborhood for a particular dataset.</li>
</ul>
</div></blockquote>
<p>When running a searchlight (<a class="reference internal" href="matlab/cosmo_searchlight.html#cosmo-searchlight"><span class="std std-ref">cosmo searchlight</span></a>) with a <a class="reference internal" href="#cosmomvpa-measure">cosmomvpa_measure</a> (see below), data from <code class="docutils literal"><span class="pre">.fa</span></code> and <code class="docutils literal"><span class="pre">.a</span></code> from the neighborhood are combined with the <code class="docutils literal"><span class="pre">.samples</span></code> and <code class="docutils literal"><span class="pre">.sa</span></code> output from the measure to form a full dataset structure with fields <code class="docutils literal"><span class="pre">.samples</span></code>, <code class="docutils literal"><span class="pre">.sa</span></code>, <code class="docutils literal"><span class="pre">.fa</span></code>, and <code class="docutils literal"><span class="pre">.a</span></code>.</p>
<p>Neighborhood-related functions include:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="matlab/cosmo_spherical_neighborhood.html#cosmo-spherical-neighborhood"><span class="std std-ref">cosmo spherical neighborhood</span></a>: for fMRI spherical volume-based searchlight (c.f. <a class="reference internal" href="references.html#kgb06" id="id3">[KGB06]</a>), and MEEG source-space searchlight.</li>
<li><a class="reference internal" href="matlab/cosmo_surficial_neighborhood.html#cosmo-surficial-neighborhood"><span class="std std-ref">cosmo surficial neighborhood</span></a>: for fMRI surface-based searchlight (c.f. <a class="reference internal" href="references.html#owd-11" id="id4">[OWDD11]</a>).</li>
<li><a class="reference internal" href="matlab/cosmo_interval_neighborhood.html#cosmo-interval-neighborhood"><span class="std std-ref">cosmo interval neighborhood</span></a>: for MEEG searchlight for time or frequency domain (c.f. <a class="reference internal" href="references.html#lto-14" id="id5">[LTO+14]</a>).</li>
<li><a class="reference internal" href="matlab/cosmo_meeg_chan_neighborhood.html#cosmo-meeg-chan-neighborhood"><span class="std std-ref">cosmo meeg chan neighborhood</span></a>: for MEEG searchlight over sensors.</li>
</ul>
</div></blockquote>
<p>The <a class="reference internal" href="matlab/cosmo_cross_neighborhood.html#cosmo-cross-neighborhood"><span class="std std-ref">cosmo cross neighborhood</span></a> can <em>cross</em> different neighborhoods, which provides functionality for:</p>
<blockquote>
<div><ul class="simple">
<li>fMRI time-space searchlight, if multiple time points are associated with each trial condition; achieved by crossing a spherical or surficial neighborhood with an interval neighborhood (for the time dimension).</li>
<li>MEEG time-space searchlight; achieved by crossing a an interval neighborhood (for the time dimension) with a channel or source MEEG neighorhood.</li>
<li>MEEG time-space-frequency searchlight: achieved by crossing two interval neighborhoods (for the time and frequency dimensions) with a third (channel or source MEEG) neighborhood (<a class="reference internal" href="references.html#lto-14" id="id6">[LTO+14]</a>).</li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/cosmomvpa_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">CoSMoMVPA concepts</a><ul>
<li><a class="reference internal" href="#dataset">Dataset</a><ul>
<li><a class="reference internal" href="#attributes">Attributes</a><ul>
<li><a class="reference internal" href="#sample-attributes">Sample attributes</a></li>
<li><a class="reference internal" href="#feature-attributes">Feature attributes</a></li>
<li><a class="reference internal" href="#dataset-attributes">Dataset attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#targets">Targets</a></li>
<li><a class="reference internal" href="#chunks">Chunks</a></li>
<li><a class="reference internal" href="#samples-sample-attributes-feature-attributes-dataset-attributes-dataset">Samples + sample attributes + feature attributes + dataset attributes = dataset</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dataset-operations">Dataset operations</a><ul>
<li><a class="reference internal" href="#slicing">Slicing</a></li>
<li><a class="reference internal" href="#slicing-related-functions">Slicing-related functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#classifier">Classifier</a></li>
<li><a class="reference internal" href="#measure">Measure</a></li>
<li><a class="reference internal" href="#neighborhood">Neighborhood</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="mvpa_concepts.html"
                        title="previous chapter">Multivariate pattern analysis</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="documentation.html"
                        title="next chapter">Documentation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/cosmomvpa_concepts.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="documentation.html" title="Documentation"
             >next</a> |</li>
        <li class="right" >
          <a href="mvpa_concepts.html" title="Multivariate pattern analysis"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CoSMoMVPA</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="get_started.html" >Get Started</a> &#187;</li> 
      </ul>
    </div>
      <div class="footer">
       <span class="creativecommons">
          <a href="http://opensource.org/licenses/MIT" >
          <img src="_static/mit-license_logo.png"
               border="0" alt="Creative Commons License"/>
         </a> 
         
        <a href="copyright.html">Copyright 2013-2016 Nikolaas N. Oosterhof, Andrew C. Connolly, CoSMoMVPA contributors</a>.
        CoSMoMVPA is licensed under a <a href="http://opensource.org/licenses/MIT">Expat (MIT) License</a>.
       </span>
      </div>
  </body>
</html>